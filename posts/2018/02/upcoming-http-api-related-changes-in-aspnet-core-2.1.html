
<!DOCTYPE html>
<html lang="en">
        <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

        <title>Miroslav Popovic - Upcoming HTTP API related changes in ASP.NET Core 2.1</title>
        <meta name="description" content="Full-stack .NET and JavaScript software architect" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">        

        <link type="application/rss+xml" rel="alternate" title="Miroslav Popovic" href="/feed.xml" />
                <link type="application/atom+xml" rel="alternate" title="Miroslav Popovic" href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/clean-blog.css" rel="stylesheet" />
        <link href="/assets/css/master.css" rel="stylesheet" />
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
        <link href="/assets/css/override.css" rel="stylesheet" />


        <meta name="application-name" content="Miroslav Popovic" />
        <meta name="msapplication-tooltip" content="Miroslav Popovic" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Miroslav Popovic - Upcoming HTTP API related changes in ASP.NET Core 2.1" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://miroslavpopovic.com/posts/2018/02/upcoming-http-api-related-changes-in-aspnet-core-2.1" />
        <!-- TODO: More social graph meta tags -->

        <script src="/assets/js/jquery.min.js"></script>
        <script src="/assets/js/bootstrap.min.js"></script>     
        <script src="/assets/js/highlight.pack.js"></script>   
        <script src="/assets/js/clean-blog.js"></script>
        <script src="/assets/js/d3.v3.min.js"></script>
        <script src="/assets/js/trianglify.min.js"></script>
        <script src="/assets/js/Please-compressed.js"></script>
        <script src="/assets/js/background-check.min.js"></script>
                
        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
                <script src="/assets/js/html5shiv.js"></script>
                <script src="/assets/js/respond.min.js"></script>
        <![endif]-->
        
                <!-- Icons -->
        <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
        <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192">
        <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
        <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
        <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
        <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">


        </head>
        <body>
                
                <!-- Navigation -->
                <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
                        <div class="container-fluid">
                                <!-- Brand and toggle get grouped for better mobile display -->
                                <div class="navbar-header page-scroll">
                                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        </button>
                                        <a class="navbar-brand" href="/">Miroslav Popovic</a>
                                </div>
                        
                                <!-- Collect the nav links, forms, and other content for toggling -->
                                <div class="collapse navbar-collapse" id="navbar-collapse">
                                        <ul class="nav navbar-nav navbar-right">
                                                        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About Me</a></li>
 
                                        </ul>
                                </div>
                                <!-- /.navbar-collapse -->
                        </div>
                        <!-- /.container -->
                </nav>
                
                <!-- Page Header -->
                <header class="intro-header" id="intro-header">
                        <div class="container">
                                <div class="row">
                                        <div class="col-md-12">

    
<div class="post-heading">
    <h1>Upcoming HTTP API related changes in ASP.NET Core 2.1</h1>
    <div class="meta">        
Published on Sunday, February 18, 2018<br>    </div>
        <div class="tags">
                    <a role="button" href="/tags/api" class="btn btn-default btn-xs">api</a>
                    <a role="button" href="/tags/apicontroller" class="btn btn-default btn-xs">apicontroller</a>
                    <a role="button" href="/tags/aspnetcore" class="btn btn-default btn-xs">aspnetcore</a>
        </div>     
</div>
                                        </div>
                                </div>
                        </div>
                </header>
                
                <!-- Main Content -->
                <div class="container">
                        <div class="row">
                                <div id="content" class="col-md-12">
                                        

<p>Two weeks ago ASP.NET team <a href="https://blogs.msdn.microsoft.com/webdev/2018/02/02/asp-net-core-2-1-roadmap/">unveiled</a> it's roadmap for ASP.NET Core 2.1 release. In addition to some highly expected features like new SignalR version, Identity changes and WebHooks, the things that I'm most excited of are Web API improvements. These changes are summed up in an initiative with a funny name - <a href="https://github.com/aspnet/Mvc/projects/5">Project KodKod</a> - and a goal &quot;to make MVC into a opinionated, forward-thinking, batteries included framework for HTTP APIs&quot;.</p>
<p><img src="/images/2018-02/aspnet-mvc-project-kodkod.png" class="img-fluid" alt="Project KodKod" /></p>
<p>Ever since ASP.NET Web API was introduced, almost 6 years ago, it became THE way that I was working with ASP.NET. I used it mostly to build a backend for SPA applications and on a few API only projects. My experience of building APIs is summed up in a talk that I've been presenting on local conferences and user group meetings, called &quot;Building production ready APIs with ASP.NET Core 2.0&quot;. The samples and the conference PowerPoint presentations can be found <a href="https://github.com/miroslavpopovic/production-ready-apis-sample">on GitHub</a>. As ASP.NET Core 2.1 is coming with a number of new API-related features, it could be a good time to update my presentation. So, let's see what are some of those features...</p>
<h2 id="https-by-default">HTTPS by default</h2>
<p>While not really an API specific feature, it's something that is more or less a must for public facing APIs. When you create a new ASP.NET Core 2.1 project, the template will enable HTTPS by default. A default local certificate will be created during .NET Core SDK installation. There will also be a new tool for managing certificates that will probably be installed as global tool. Global tools are a feature similar to Node global tools which will enable creation and distribution of tools ecosystem via NuGet. You can read more about it on <a href="https://blogs.msdn.microsoft.com/dotnet/2018/02/02/net-core-2-1-roadmap/">.NET Core 2.1 roadmap</a>.</p>
<p>In addition to HTTPS by default, the template will also enable HSTS - <a href="https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security">HTTP Strict Transport Security</a> protocol - which will prevent browsers to try HTTP address. HTTPS will be forced.</p>
<h2 id="better-swagger-openapi-specification-support">Better Swagger / OpenAPI specification support</h2>
<p>For a long time, Swagger was de facto a standard for describing RESTful APIs but there were other tools too. That changed last year when SmartBear Software, a company behind Swagger, <a href="https://swagger.io/blog/announcing-openapi-3-0/">donated</a> Swagger 2.0 specification to the OpenAPI initiative. Today, it's known as <a href="https://www.openapis.org/">OpenAPI specification 3.0</a> and it's backed up by all the big players in API space.</p>
<p>ASP.NET Core 2.1 will come with a new type - <code>ActionResult&lt;T&gt;</code> which will enable discoverability of the action result type, without the need for additional attributes that is required now to get the correct metadata.</p>
<p>Also, a new tool will be added for build-time OpenAPI generation - at the moment we have only runtime generation. More features are planned for future versions.</p>
<h2 id="apicontroller-attribute"><code>[ApiController]</code> attribute</h2>
<p>This is my favorite new feature that will bring back some conventions we had in old ASP.NET Web API. Basically, you will decorate controller class with <code>[ApiController]</code> and MVC will be able to infer some defaults and do additional processing on your action methods. This is what we will have for start:</p>
<h3 id="automatic-model-state-validation">Automatic model state validation</h3>
<p>No need to write <code>if (!ModelState.IsValid) return BadRequest(ModelState);</code>. Validation will be done automatically before calling your action method.</p>
<p>One of the <em>best practices</em> I've been preaching is <a href="https://github.com/miroslavpopovic/production-ready-apis-sample/blob/44870228b8c9952ca33ee791d80aacfa4256b762/BoardGamesApi/Models/ApiResult.cs">wrapping a response in an object</a> that has properties like <code>Error</code> and <code>IsSuccessful</code> in addition to the actual data. ASP.NET Core 2.1 will take a different approach by introducing a validation error response in the shape of <a href="https://tools.ietf.org/html/rfc7807">RFC 7807</a> standardized response, but you will be able to override it.</p>
<h3 id="inferring-defaults-on-action-method-parameters">Inferring defaults on action method parameters</h3>
<p>One thing that we lost in transition from the old ASP.NET Web API were automatic recognition of the source for action method parameters. This is coming back to ASP.NET Core 2.1 controllers decorated with <code>[ApiController]</code>. <code>[FromBody]</code> will be default for complex types. <code>[FromRoute]</code> will be used when possible and otherwise <code>[FromQuery]</code>.</p>
<h3 id="other">Other</h3>
<p>There are few more things that will be enabled with the new <code>[ApiController]</code> attribute. You can find more in depth review of this attribute in <a href="https://www.strathweb.com/2018/02/exploring-the-apicontrollerattribute-and-its-features-for-asp-net-core-mvc-2-1/">a post by Filip W</a>.</p>
<h2 id="sample">Sample</h2>
<p>To summarize, let's take a look at one of the action methods that I have in my presentation sample code, and how it would look like in ASP.NET Core 2.1.</p>
<pre><code>// Sample: ASP.NET Core 2.0
[Authorize]
[Route(&quot;api/games&quot;)]
public class GamesController : Controller
{
    private readonly IGamesRepository _gamesRepository;

    public GamesController(IGamesRepository gamesRepository)
    {
        _gamesRepository = gamesRepository;
    }
    
    /// &lt;summary&gt;
    /// Create a new game from the supplied data.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;model&quot;&gt;Data to create the game from.&lt;/param&gt;
    /// &lt;response code=&quot;200&quot;&gt;Returns the created game.&lt;/response&gt;
    [Authorize(Roles = &quot;admin&quot;)]
    [HttpPost]
    [ProducesResponseType(typeof(ApiResult&lt;Game&gt;), 200)]
    public IActionResult Post([FromBody] GameInput model)
    {
        if (!ModelState.IsValid)
            return BadRequest(ModelState);

        var game = new Game();
        model.MapToGame(game);

        _gamesRepository.Create(game);

        var url = $&quot;{Request.Scheme}://{Request.Host}/api/games/{game.Id}&quot;;

        return Created(url, game.WrapData());
    }       
}
</code></pre>
<pre><code>// Sample: ASP.NET Core 2.1
[ApiController]
[Authorize]
[Route(&quot;api/games&quot;)]
public class GamesController : Controller
{
    private readonly IGamesRepository _gamesRepository;

    public GamesController(IGamesRepository gamesRepository)
    {
        _gamesRepository = gamesRepository;
    }
    
    /// &lt;summary&gt;
    /// Create a new game from the supplied data.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;model&quot;&gt;Data to create the game from.&lt;/param&gt;
    [Authorize(Roles = &quot;admin&quot;)]
    [HttpPost]
    public ActionResult&lt;Game&gt; Post(GameInput model)
    {
        // No model state validation code here, hooray!

        var game = new Game();
        model.MapToGame(game);

        _gamesRepository.Create(game);

        var url = $&quot;{Request.Scheme}://{Request.Host}/api/games/{game.Id}&quot;;

        return Created(url, game);
    }       
}
</code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>Since I haven't posted on my blog in a while, I felt obliged to share some of my thoughts on the current state of .NET (Core).</p>
<p>As a long-time ASP.NET developer, it's really nice to see how rejuvenated ASP.NET Core is rapidly improving with each version. At one moment, before .NET Core became a thing, it looked like .NET ecosystem became stale. Even I (an early proponent of .NET) have took <a href="http://javascriptkicks.com/articles/147418/learning-node-js-and-react-while-building-a-product">a foray into Node</a>.</p>
<p>.NET Core, .NET Standard and ASP.NET Core have brought back the hope for .NET developers in general. Open-source approach, multi-platform, beautiful C# language and a great performance could make ASP.NET Core a framework of choice and a force to recon in the server-side world.</p>
<p>We could even see a full-stack C# (similar to full-stack JavaScript with Node). Blazor, an experiment to create a client-side .NET web framework that's running in a browser via Web Assembly is now on ASP.NET team's <a href="https://github.com/aspnet/Blazor">GitHub repository</a>. To learn more about it, watch <a href="https://www.youtube.com/watch?v=Ta_qXpXQqGQ">ASP.NET Community Standup</a> from two weeks ago.</p>
<p><em>If you didn't know, ASP.NET Community Standups have a new home on YouTube, under the <a href="https://www.youtube.com/channel/UCiaZbznpWV1o-KLxj8zqR6A/videos">.NET Foundation channel</a>.</em></p>
<p>Finally, after some struggle, the future of .NET looks bright!</p>


<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'miroslavpopovic';
    var disqus_identifier = 'upcoming-http-api-related-changes-in-aspnet-core-2.1';
    var disqus_title = 'Upcoming HTTP API related changes in ASP.NET Core 2.1';
    var disqus_url = 'https://miroslavpopovic.com/posts/2018/02/upcoming-http-api-related-changes-in-aspnet-core-2.1';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

                                </div>
                        </div>
                </div>
                
                <hr>
                
                <!-- Footer -->
                <footer>
                        <div class="container">
    <div class="row">
        <div class="col-md-12 text-center">

            <ul class="list-inline">
                <li>
                    <a href="https://twitter.com/miroslavpopovic" target="_blank" title="Twitter Profile">
                        <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                        </span>
                    </a>
                </li>
                <li>
                    <a href="https://github.com/miroslavpopovic" target="_blank" title="Github Profile">
                        <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                        </span>
                    </a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/miroslavpopovic/" target="_blank" title="LinkedIn Profile">
                        <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                        </span>
                    </a>
                </li>
                <li>
                    <a href="https://plus.google.com/+MiroslavPopovic" target="_blank" title="Google+ Profile">
                        <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-google-plus fa-stack-1x fa-inverse"></i>
                        </span>
                    </a>
                </li>
                <li>
                    <a href="https://stackoverflow.com/users/119230" target="_blank" title="Stack Overflow Profile">
                        <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                        </span>
                    </a>
                </li>
                <li>
                    <a href="http://www.codeproject.com/Members/Miroslav-Popovic" target="_blank" title="Code Project Profile">
                        <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-file-text-o fa-stack-1x fa-inverse"></i>
                        </span>
                    </a>
                </li>
            </ul>

            <p class="copyright text-muted">
                    <a href="/feed.xml" class="btn-rss">
                        <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                        </span> RSS Feed
                    </a>
                                    <a href="/feed.atom" class="btn-rss">
                        <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                        </span> Atom Feed
                    </a>
                <br />
                Copyright © 2018 by Miroslav Popovic
                <br />
                <strong><a href="https://wyam.io" target="_blank">Generated by Wyam</a></strong>
            </p>
        </div>
    </div>
</div>

                </footer> 

                <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-32542962-1', 'auto');
ga('send', 'pageview');
</script>

                <script>hljs.initHighlightingOnLoad();</script>

                        <script type="text/javascript">                
                                // Header background                        
                                var colors = Please.make_color({
                                        colors_returned: 3,
                                        saturation: .6
                                });
                                var t = new Trianglify({
                                        x_gradient: colors,
                                        y_gradient: ["#FFFFFF"]
                                });
                                var header = document.getElementById("intro-header");
                                var pattern = t.generate(header.clientWidth, header.clientHeight);
                                header.setAttribute('style', 'background-image: ' + pattern.dataUrl);                        
                        </script>

                <script>
                        BackgroundCheck.init({
                                targets: '.intro-header,.navbar',
                                images: '.intro-header'
                        });
                </script>
        </body>
</html>

